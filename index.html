<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State-Chart</title>
    <link href="./assets/fontawesome/css/all.css" rel="stylesheet" />
    <link rel="stylesheet" href="./assets/fontawesome/css/fontawesome.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="./style.css">

</head>

<body>
    <div id="container">

        <div class="wrapper">
            <div>
                <div id="circle-1" class="circle smstate-content">

                    <span class="fas fa-play text-success" style="font-size: 2rem;"></span>

                    <div class="wrapper-actions-state">
                        <a title="Add Action" class="delete-action mr-1"><span
                                class="fas fa-plus text-success"></span></a>
                        <a title="Edit Status" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
                        <a title="Delete Status" class="delete-action mr-1"><span
                                class="fas fa-trash text-danger"></span></a>
                    </div>
                </div>

            </div>
        </div>

        <div class="wrapper">
            <div>
                <div id="circle-2" class="circle smstate-content">
                    state-2
                    <div class="wrapper-actions-state">
                        <a title="Add Action" class="delete-action mr-1"><span
                                class="fas fa-plus text-success"></span></a>
                        <a title="Edit Status" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
                        <a title="Delete Status" class="delete-action mr-1"><span
                                class="fas fa-trash text-danger"></span></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="wrapper">
            <div>
                <div id="circle-3" class="circle smstate-content">
                    State-3
                    <div class="wrapper-actions-state">
                        <a title="Add Action" class="delete-action mr-1"><span
                                class="fas fa-plus text-success"></span></a>
                        <a title="Edit Status" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
                        <a title="Delete Status" class="delete-action mr-1"><span
                                class="fas fa-trash text-danger"></span></a>
                    </div>
                </div>

            </div>
        </div>

        <div class="wrapper">
            <div>
                <div id="circle-4" class="circle">

                </div>
                <!-- <div>
                    <div id="a8" class="action">action-8</div>
                    <div id="a9" class="action">action-9</div>
                </div> -->
            </div>
        </div>
    </div>

    <script src="bundle/dist/jsplumb.bundle.js"></script>

    <script>


        var conatiner = document.getElementById("container");
        var circle1 = document.getElementById("circle-1");
        var circle2 = document.getElementById("circle-2");
        var circle3 = document.getElementById("circle-3");
        var circle4 = document.getElementById("circle-4");

        var instance = jsPlumbBrowserUI.newInstance({
            container: conatiner
        })

        //         var sourceEndpoint = instance.addEndpoint(element, {
        //     source:true,
        //     endpoint:"Dot"    
        // });

        // var targetEndpoint = instance.addEndpoint(element, {
        //     target:true,
        //      endpoint:"Rectangle"    
        // });

        window.addEventListener('resize', () => {
            console.log("resize")
            instance.repaintEverything();

        });

        updateChart();

        // expected to take state and action data
        function updateChart() {

            //take state and draw divs related to state and add to container

            instance.connect({
                source: circle1,
                target: circle2,
                //connector: "Flowchart",
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 70,
                        cornerRadius: 25
                    }
                },
                anchor: "Right",
                overlays: [
                    {
                        type: "Custom",
                        options: {
                            create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon ApprovalAction" title="Approval Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35
                        }
                    },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle1,
                target: circle3,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 140,
                        cornerRadius: 25
                    }
                },
                anchor: "Right",
                overlays: [
                    { type: "Custom", options: { create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon CommandAction" title="Command Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle1,
                target: circle4,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 210,
                        cornerRadius: 25
                    }
                },
                anchor: "Right",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon TimerAction" title="Timer Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle3,
                target: circle1,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 140,
                        cornerRadius: 25
                    }
                },
                anchor: "Left",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon HierarchalApprovalAction" title="Hierarchal Approval Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle3,
                target: circle2,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 70,
                        cornerRadius: 25
                    }
                },
                anchor: "Left",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon TimerAction" title="Timer Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle3,
                target: circle4,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 70,
                        cornerRadius: 25,
                    }
                },
                anchor: "Right",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon CommandAction" title="Command Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle4,
                target: circle2,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 210,
                        cornerRadius: 25
                    }
                },
                anchor: "Left",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon ApprovalAction" title="Approval Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            instance.connect({
                source: circle2,
                target: circle3,
                connector: {
                    type: "Flowchart",
                    options: {
                        stub: 70,
                        cornerRadius: 25
                    }
                },
                anchor: "Right",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon ConditionalAction" title="Conditional Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })

            // instance.connect({
            //     source: circle2,
            //     target: circle4,
            //     connector: {
            //         type: "Flowchart",
            //         options: {
            //             stub: 280,
            //             cornerRadius: 25
            //         }
            //     },
            //     anchor: "Right",
            //     overlays: [
            //         { type: "Label", options: { label: "Action 9", location: 0.35 } },
            //         { type: "PlainArrow", options: { location: 1, width:10, length:10  } }
            //     ]
            // })

            instance.connect({
                source: circle2,
                target: circle2,
                connector: "StateMachine",
                anchor: "Top",
                overlays: [
                    { type: "Custom", options: {   create: (component) => {
                                const d = document.createElement("div")
                                d.classList.add("smaction");
                                d.innerHTML = `
                                <div class="wrapper-state-action-model-name d-flex">
        <div 
             class="wrapper-state-action-model-name-icon FormAction" title="Form Action">

        </div>
        <div class="state-action-model-name">
            action
        </div>
    </div>
                                <div class="wrapper-action-state">
        <a title="تعديل" class="delete-action mr-1"><span class="fas fa-edit"></span></a>
        <a title="حذف" class="delete-action mr-1"><span class="fas fa-trash text-danger"></span></a>
        <a title="Add Target Link" class="add-link mr-1">
            <span class="fas fa-link"></span>
        </a>
    
            <a title="Add Reject Link" class="add-link mr-1">
                <span class="fas fa-link text-danger"></span>
            </a>
 

    </div>
                                `
                                return d
                            }, location: 0.35 } },
                    { type: "PlainArrow", options: { location: 1, width: 10, length: 10 } }
                ]
            })
        }

    </script>
</body>

</html>